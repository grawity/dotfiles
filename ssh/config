# vim: ft=sshconfig
# NOTE: The '#if' directives are processed by the 'ssh/generate' script, not OpenSSH.

# -- Own hosts --

Host blizzard.nullroute.lt
	User mantas

#if star
# Use direct IPv4 peering with better throughput (~900 Mbps IPv4 vs ~220 Mbps IPv6)
Host ember.nullroute.lt
	AddressFamily inet
Host wind.nullroute.lt
	AddressFamily inet
#endif

#if @(ember|wind)
# Use direct IPv4 peering with better throughput (~900 Mbps IPv4 vs ~220 Mbps IPv6)
Host star.nullroute.lt
	AddressFamily inet
#endif

#if @(rain|midnight)
Host vm-vol5 vm-vol5.nullroute.lt
	HostkeyAlias vm-vol5.nullroute.lt
	HostName 193.219.181.193
	Port 56378
#endif

Host bmc.*.nullroute.lt
	KexAlgorithms +diffie-hellman-group14-sha1
	HostKeyAlgorithms +ssh-rsa
	User Administrator

Host ember-alt ember-bypass
	HostKeyAlias ember.nullroute.lt
	HostName alt.ember.nullroute.lt
	PKCS11Provider none

Host wind-alt
	HostKeyAlias wind.nullroute.lt
	HostName alt.wind.nullroute.lt
	PKCS11Provider none

# RouterOS
Host erebus
	PubkeyAcceptedAlgorithms +ssh-rsa

Host *.nullroute.lt
	GSSAPIAuthentication yes
	ForwardAgent yes

# -- Other hosts --

Host aur
	HostName aur.archlinux.org
	User aur

Host shell.*.burble.dn42
	User nullroute

Host eisner
	HostName %h.encompasserve.org
	HostKeyAlgorithms +ssh-rsa
	PubkeyAcceptedAlgorithms +ssh-rsa
	User mikulenas

Host sdf sdf.org
	HostName tty.sdf.org

Host sdf-eu sdf.eu
	HostName sdf-eu.org

Host theos
	HostName %h.kyriasis.com

# -- Work --

Host radius-console
	HostName 10.34.1.14
	User cons

#if ember
Host *.utenos-kolegija.lt
	PKCS11Provider libopencryptoki.so
#else
Host *.utenos-kolegija.lt
	PKCS11Provider p11-kit-proxy.so
#endif

# RouterOS 6.48.3 seems to support RSA-SHA2 for host keys, but still doesn't
# accept such signatures for user keys.
Host gw-b56.utenos-kolegija.lt gw-m18.utenos-kolegija.lt
	PubkeyAcceptedAlgorithms +ssh-rsa

# -- Global settings --

Host ubnt
	HostName 192.168.1.20
	User ubnt
	UserKnownHostsFile /dev/null
	GlobalKnownHostsFile /dev/null
	StrictHostKeyChecking no
	ControlPersist no

# Enable GSSAPI for single-label names, but not for FQDNs
Match canonical host *.*
	GSSAPIAuthentication no
Match canonical host *
	GSSAPIAuthentication yes

#if @(rain|midnight)
# Deal with Telia CGNAT timeouts
Host *
	ServerAliveInterval 10s
#endif

#if @(ember|frost|wind)
Host *
	ControlPersist 1h
#endif

#if frost
Host * !ember !*.nullroute.lt
	IdentityFile ~/.dotfiles/ssh/id_tpm.pub
	PKCS11Provider p11-kit-proxy.so
#endif

Host *
	CanonicalizeHostname yes
	CanonicalDomains nullroute.lt utenos-kolegija.lt ukolegija.lt
	Protocol 2
	HashKnownHosts no
	VerifyHostKeyDNS yes
	SendEnv LANG TZ
	ControlPath ~/.ssh/S.%r@%h:%p
	ControlMaster auto
	ControlPersist 15s
